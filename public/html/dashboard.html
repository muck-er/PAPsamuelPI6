<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Dashboard OthrysFit</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Ajustes de cores para dar um toque mais profissional */
    .bg-light {
      background-color: #f4f7f6 !important; /* Cor suave para o fundo */
    }

    .card-header {
      background-color: #007bff; /* Azul mais escuro */
      color: white;
    }

    .card-body {
      background-color: white;
    }

    .card {
      border-radius: 10px;
      box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
    }

    h2 {
      font-family: 'Arial', sans-serif;
      font-weight: 600;
      color: #333;
    }

    /* Estilos para a tabela de treinos */
    .table-striped tbody tr:hover {
      background-color: #f1f1f1; /* Cor suave ao passar o mouse */
    }

    th {
      font-weight: 600;
      background-color: #f8f9fa;
    }

    /* Ajustes nos botões */
    .btn-outline-success {
      border-radius: 20px;
    }

    /* Animar a entrada do conteúdo */
    .fadeIn {
      animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Responsividade para telas menores */
    @media (max-width: 768px) {
      .container {
        padding-left: 10px;
        padding-right: 10px;
      }

      h2 {
        font-size: 1.5rem;
      }
    }

    .completed {
      text-decoration: line-through;
      color: gray;
    }
  </style>
</head>
<body class="bg-light">

<div class="container mt-5">
  <h2 class="mb-4">Olá, bem-vindo à tua dashboard</h2>

  <!-- Plano de Treino -->
  <div class="card mb-4 fadeIn">
    <div class="card-header bg-primary text-white">Plano de Treino</div>
    <div class="card-body">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Dia</th>
            <th>Exercício</th>
            <th>Duração</th>
          </tr>
        </thead>
        <tbody id="tabela-treinos"></tbody>
      </table>
    </div>
  </div>

  <!-- Objetivos -->
  <div class="card fadeIn">
    <div class="card-header bg-success text-white">Objetivos</div>
    <div class="card-body">
      <ul class="list-group" id="lista-objetivos"></ul>
    </div>
  </div>
</div>

<script>
  function carregarDashboard() {
    fetch('carregar_dashboard.php')
      .then(res => res.json())
      .then(data => {
        const treinoTable = document.getElementById("tabela-treinos");
        treinoTable.innerHTML = "";
        data.treinos.forEach(item => {
          const [dia, exercicio, duracao] = item.split(" - ");
          treinoTable.innerHTML += `
            <tr>
              <td>${dia}</td>
              <td>${exercicio}</td>
              <td>${duracao}</td>
            </tr>`;
        });

        const objetivosList = document.getElementById("lista-objetivos");
        objetivosList.innerHTML = "";
        data.objetivos.forEach(obj => {
          const className = obj.concluido ? "completed" : "";
          const badge = obj.concluido ? "success" : "secondary";
          const estado = obj.concluido ? "Feito" : "Pendente";
          const botao = obj.concluido ? '' : `<button class="btn btn-sm btn-outline-success ms-3" onclick="marcarFeito(${obj.id})"><i class="fas fa-check-circle"></i> Marcar como feito</button>`;
          objetivosList.innerHTML += `
            <li class="list-group-item d-flex justify-content-between align-items-center ${className}">
              <span>${obj.descricao}</span>
              <div>
                <span class="badge bg-${badge}">${estado}</span>
                ${botao}
              </div>
            </li>`;
        });
      });
  }

  function marcarFeito(idObjetivo) {
    fetch('marcar_objetivo_feito.php', {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: 'id=' + idObjetivo
    }).then(() => carregarDashboard());
  }

  carregarDashboard();
</script>

</body>
</html>
